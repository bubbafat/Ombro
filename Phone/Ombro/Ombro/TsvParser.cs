using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Ombro
{
    internal class TsvParser
    {

        /*
         * #
# U.S. Geological Survey
# National Water Information System
# Retrieved: 2013-12-26 10:41:45 EST      (sdww01)
#
# ---------------------WARNING---------------------
# The data you have obtained from this automated
# U.S. Geological Survey database have not received
# Director's approval and as such are provisional
# and subject to revision.  The data are released
# on the condition that neither the USGS nor the
# United States Government may be held liable for
# any damages resulting from its use.
#
# Further Descriptions of the parameter_cd column can be found at:
# http://waterdata.usgs.gov/nwis/pmcodes
# Further Descriptions of codes in the result_cd column can be found at:
# http://waterdata.usgs.gov/nwis/help?codes_help#surface_water
#
# This information includes the following fields:
#
#  agency_cd    Agency Code
#  station_nm   Station Name
#  site_no      USGS station number
#  dd_nu        Data Descriptor Number
#  parameter_cd Parameter Code
#  result_dt    Date that the result was taken
#  result_tz_cd Time datum
#  result_va    Current value
#  result_cd    Code to show data quality
#  result_md    Date the result was modified in the NWIS database
#
agency_cd	site_no	station_nm	dd_nu	precip_interval_tx	parameter_cd	result_dt	result_tz_cd	result_va	result_cd	result_md
5s	15s	50s	2n	7s	5s	12d	6s	12s	2s	12d
USGS	02066000	ROANOKE (STAUNTON) RIVER AT RANDOLPH, VA	08	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:02:04
USGS	02069000	DAN RIVER AT PINE HALL, NC	06	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:30:04
USGS	02071900	PHILPOTT RES AT PHILPOTT DAM NR PHILPOTT, VA	12	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:02:04
USGS	02079241	ISLAND CREEK RESERVOIR AT DAM NEAR CLARKSVILLE, VA	11	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:32:03
USGS	02079490	JOHN H. KERR RESERVOIR AT DAM NEAR BOYDTON, VA	02	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:32:03
USGS	02082585	TAR RIVER AT NC 97 AT ROCKY MOUNT, NC	14	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:10:03
USGS	02084000	TAR RIVER AT GREENVILLE, NC	27	p24h_va	00045	2013-12-26 09:45:00	EST	0.02		2013-12-26 10:10:03
USGS	0208706575	BEAVERDAM CREEK AT DAM NEAR CREEDMOOR, NC	03	p24h_va	00045	2013-12-26 10:30:00	EST	0.01		2013-12-26 10:38:04
USGS	02087182	FALLS LAKE ABOVE DAM NR FALLS, NC	02	p24h_va	00045	2013-12-26 10:00:00	EST	0.01		2013-12-26 10:16:03
USGS	02087275	CRABTREE CREEK AT HWY 70 AT RALEIGH, NC	03	p24h_va	00045	2013-12-26 10:00:00	EST	0.04		2013-12-26 10:10:03
USGS	02087322	CRABTREE CR AT OLD WAKE FOREST RD AT RALEIGH, NC	14	p24h_va	00045	2013-12-26 10:00:00	EST	0.05		2013-12-26 10:10:03
USGS	0208732534	PIGEON HOUSE CR AT CAMERON VILLAGE AT RALEIGH, NC	03	p24h_va	00045	2013-12-26 09:45:00	EST	0.03		2013-12-26 10:02:04
USGS	0208732885	MARSH CREEK NEAR NEW HOPE, NC	02	p24h_va	00045	2013-12-26 10:30:00	EST	0.04		2013-12-26 10:40:02
USGS	0208735012	ROCKY BRANCH BELOW PULLEN DRIVE AT RALEIGH, NC	16	p24h_va	00045	2013-12-26 10:30:00	EST	0.04		2013-12-26 10:34:04
USGS	02087359	WALNUT CREEK AT SUNNYBROOK DRIVE NR RALEIGH, NC	12	p24h_va	00045	2013-12-26 10:30:00	EST	0.01		2013-12-26 10:34:04
USGS	02087580	SWIFT CREEK NEAR APEX, NC	15	p24h_va	00045	2013-12-26 09:45:00	EST	0.06		2013-12-26 10:02:04
USGS	02093800	REEDY FORK NEAR OAK RIDGE, NC	12	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:48:03
USGS	0209399200	HORSEPEN CREEK AT US 220 NR GREENSBORO, NC	03	p24h_va	00045	2013-12-26 09:40:00	EST	0		2013-12-26 09:50:02
USGS	02094659	SOUTH BUFFALO CREEK NR POMONA, NC	03	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:47:05
USGS	02094770	SOUTH BUFFALO CREEK AT US 220 AT GREENSBORO, NC	01	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:50:02
USGS	02094775	RYAN CREEK BELOW US 220 AT GREENSBORO, NC	01	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:50:02
USGS	02095000	SOUTH BUFFALO CR NEAR GREENSBORO, NC	02	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:34:04
USGS	02095181	N BUFFALO CR AT WESTOVER TERRACE AT GREENSBORO, NC	03	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:47:05
USGS	02095271	NORTH BUFFALO CREEK AT CHURCH ST AT GREENSBORO, NC	01	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:00:03
USGS	02095500	NORTH BUFFALO CREEK NEAR GREENSBORO, NC	03	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:48:03
USGS	0209553650	BUFFALO CREEK AT SR2819 NR MCLEANSVILLE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:34:04
USGS	02096500	HAW RIVER AT HAW RIVER, NC	14	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:00:03
USGS	02098197	 B. EVERETT JORDAN LAKE AT DAM NR MONCURE, NC	17	p24h_va	00045	2013-12-26 10:00:00	EST	0.05		2013-12-26 10:16:03
USGS	02102908	FLAT CREEK NEAR INVERNESS, NC	01	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:02:04
USGS	02105500	CAPE FEAR R AT WILM O HUSKE LOCK NR TARHEEL, NC	16	p24h_va	00045	2013-12-26 10:30:00	EST	0.05		2013-12-26 10:34:04
USGS	02105769	CAPE FEAR R AT LOCK #1 NR KELLY, NC	17	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:56:02
USGS	02111000	YADKIN RIVER AT PATTERSON, NC	05	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:00:03
USGS	02111180	ELK CREEK AT ELKVILLE, NC	05	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:00:03
USGS	02111391	W. KERR SCOTT RESERVOIR AT DAM NR WILKESBORO, NC	02	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:02:04
USGS	02112120	ROARING RIVER NEAR ROARING RIVER, NC	14	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:02:04
USGS	02130561	PEE DEE RIVER NR BENNETTSVILLE, SC	21	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:22:03
USGS	02130840	BLACK CREEK BELOW CHESTERFIELD, SC	02	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:04:03
USGS	02142000	LOWER LITTLE RIVER NR ALL HEALING SPRINGS, NC	12	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:42:03
USGS	02143040	JACOB FORK AT RAMSEY, NC	17	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	02150495	SECOND BROAD RIVER NR LOGAN, NC	12	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:54:03
USGS	02153500	BROAD RIVER NEAR GAFFNEY, SC	04	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 10:02:04
USGS	03177120	EAST RIVER AT WILLOWTON, WV	12	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:24:03
USGS	03177480	INDIAN CREEK AT RED SULPHUR SPRINGS, WV	12	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:24:03
USGS	03179000	BLUESTONE RIVER NEAR PIPESTEM, WV	06	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:16:03
USGS	03185400	NEW RIVER AT THURMOND, WV	21	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:54:03
USGS	03189600	GAULEY RIVER BELOW SUMMERSVILLE DAM, WV	07	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:54:03
USGS	03190000	MEADOW RIVER AT NALLEN, WV	12	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:24:03
USGS	03203600	GUYANDOTTE RIVER AT LOGAN, WV	09	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:56:02
USGS	03212980	DRY FORK AT BEARTOWN, WV	05	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:04:03
USGS	341913081341500	USGS RAINGAGE AT NEWBERRY, SC	24	p24h_va	00045	2013-12-26 10:00:00	EST	0.03		2013-12-26 10:12:04
USGS	342440080443900	KER- 433 KERSHAW COUNTY NR LIBERTY HILL (REGOLITH)	03	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:50:02
USGS	343024080130600	USGS RAINGAGE NEAR MCBEE, SC	01	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:42:03
USGS	344333080503600	LAN- 497 LANCASTER COUNTY AIRPORT (REGOLITH)	03	p24h_va	00045	2013-12-26 10:15:00	EST	0.08		2013-12-26 10:32:03
USGS	344446080202600	USGS RAINGAGE NEAR PAGELAND, SC	01	p24h_va	00045	2013-12-26 09:30:00	EST	0.01		2013-12-26 09:42:03
USGS	345609080415145	RAINGAGE AT MINERAL SPRINGS, NC	02	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	345830081033100	YRK-3295 YORK COUNTY AIRPORT (BEDROCK)	02	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:34:04
USGS	350110080502045	CRN-31 RAINGAGE AT ELON PARKS AND RECREATION CNTR	04	p24h_va	00045	2013-12-26 10:25:00	EST	0		2013-12-26 10:32:03
USGS	350128081000145	CRN-38 RAINGAGE NEAR TEGA CAY, SC	02	p24h_va	00045	2013-12-26 10:05:00	EST	0		2013-12-26 10:10:03
USGS	350314080484945	CRN-08 RAINGAGE AT ST. MATTHEWS CHURCH	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	350324080551845	CRN-55 RAINGAGE AT HAMMOND FARM, FORT MILL, SC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350351080454145	CRN-07 RAINGAGE AT FIRE STATION 9, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350359080521145	CRN-06 RAINGAGE AT MCALPINE CR WWTP, PINEVILLE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350623080583801	CRN-22 RAINGAGE AT LAKE WYLIE ELEMENTARY SCHOOL	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	350624081023345	CRN-59 RAINGAGE AT YMCA CAMP THUNDERBIRD	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350627080410645	CRN-39 RAINGAGE AT NCDOT FACILITY, MATTHEWS, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350630080455845	CRN-70 RAINGAGE AT PROVIDENCE HIGH SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350635080513245	CRN-56 RAINGAGE AT SOUTH MECK HIGH SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350637080475645	CRN-48 RAINGAGE AT OLDE PROVIDENCE SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350646080432545	CRN-69 RAINGAGE AT MATTHEWS ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350657080544945	CRN-28, RAINGAGE AT CROMPTON ST AT CHARLOTTE, NC	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350815080460745	CRN-10 RAINGAGE AT MCALPINE CR AT SARDIS RD	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350823080505345	CRN-12 RAINGAGE AT FIRE STATION 16, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350842080572801	CRN-21 RAINGAGE AT KENNEDY JR. HIGH, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	350857080383245	CRN-67 RAINGAGE AT THOMPSON ROAD, MINT HILL, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350903081004545	CRN-45 RAINGAGE AT WITHERS COVE RD, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	350947080524945	CRN-13 RAINGAGE AT USGS OFFICE, CHARLOTTE, NC	02	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351001080495845	CRN-71 RAINGAGE AT ALEXANDER GRAHAM MIDDLE SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	351023080435745	CRN-17 RAINGAGE AT PINEY GROVE ELEMENTARY SCHOOL	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351028080385545	CRN-32 RAINGAGE AT BAIN ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351032080475245	CRN-20 RAINGAGE AT FIRE STATION 14, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351104080521845	CRN-60 RAINGAGE AT COLLINSWOOD ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351109080412145	CRN-57 RAINGAGE AT LEBANON ROAD ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351132080504145	CRN-19 RAINGAGE AT FREEDOM PARK, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351132080562345	CRN-04 RAINGAGE AT FIRE STATION 30, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	351145080371945	CRN-68 RAINGAGE AT WHITE FARM, MINT HILL, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351218080331345	CRN-29 RAINGAGE AT BELK SCOUT CAMP	04	p24h_va	00045	2013-12-26 10:05:00	EST	0		2013-12-26 10:10:03
USGS	351229080460245	CRN-47 RAINGAGE AT WINTERFIELD ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351229080480145	CRN-66 RAINGAGE AT CHANTILLY ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351247080592745	CRN-37 RAINGAGE AT BERRYHILL ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0.01		2013-12-26 10:38:04
USGS	351302080412701	CRN-23 RAINGAGE AT CHARLES T. MYERS GOLF COURSE	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351320080502645	CRN-15 RAINGAGE AT CHARLOTTE-MECKLENBURG GOVT CNTR	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351331080525945	CRN-11 RAINGAGE AT FIRE STATION 10, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351412080541245	CRN-53 RAINGAGE AT HARDING HIGH SCH, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	351414080463245	CRN-09 RAINGAGE AT FIRE STATION 15, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351455080374445	CRN-30 RAINGAGE AT RHYNE FARM, MINT HILL, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351502080512045	CRN-50 RAINGAGE AT BEATTIES FORD RD, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351536080410645	CRN-65 RAINGAGE AT REEDY CREEK ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351540080430045	CRN-16 RAINGAGE AT REEDY CREEK PARK ENVIR CENTER	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351553080562645	CRN-14 RAINGAGE AT FIRE STATION 21, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351604080470845	CRN-27 RAINGAGE AT HIDDEN VALLEY ELEMENTARY	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351633080493445	CRN-03 RAINGAGE AT IRWIN CR AT CHARLOTTE, NC	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351642080533445	CRN-05 RAINGAGE AT CMUD ADMIN BLDG, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:36:03
USGS	351741080475045	CRN-54 RAINGAGE AT TURNING POINT ACADEMY	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351753081011745	CRN-52 RAINGAGE AT IDA RANKIN ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351812080445545	CRN-01 RAINGAGE AT FIRE STATION 27, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351816080564345	CRN-61 RAINGAGE AT COULWOOD MIDDLE SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351822081140545	RAINGAGE AT LONG CREEK NR BESSEMER CITY, NC	02	p24h_va	00045	2013-12-26 10:35:00	EST	0		2013-12-26 10:38:04
USGS	351922080540345	CRN-18 RAINGAGE AT USPS AT SUNSET RD	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351928080515645	CRN-64 RAINGAGE AT HORNETS NEST ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	351943080323145	RAINGAGE AT ROCKY RIVER WWTP, CONCORD, NC	02	p24h_va	00045	2013-12-26 10:20:00	EST	0		2013-12-26 10:26:03
USGS	351954080493445	CRN-02 RAINGAGE AT FIRE STATION 28, CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352000080414645	CRN-33 RAINGAGE AT MALLARD CR WWTP, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352003080591245	CRN-35 RAINGAGE AT CATAWBA R AT MNT ISLAND DAM	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352006080462845	CRN-58 RAINGAGE AT MALLARD CR ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352012081154345	RAINGAGE AT PASOUR MTN RS NEAR DALLAS, NC	01	p24h_va	00045	2013-12-26 10:10:00	EST	0		2013-12-26 10:18:04
USGS	352135080462045	CRN-46 RAINGAGE AT OEHLER FARM, CHARLOTTE, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352155080531145	CRN-25 RAINGAGE AT GAR CR AT SR2120 NR OAKDALE, NC	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352224080500345	CRN-49 RAINGAGE AT NORTH MECKLENBURG HIGH	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352310080424845	CRN-51 RAINGAGE AT CONCORD REGIONAL AIRPORT	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352323080551645	CRN-41 RAINGAGE AT MCDOWELL CR NR CHARLOTTE, NC	01	p24h_va	00045	2013-12-26 09:50:00	EST	0		2013-12-26 09:54:03
USGS	352432080473745	CRN-26 RAINGAGE AT BRADFORD AIRFIELD	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352440080505045	CRN-43 RAINGAGE AT HUNTERSVILLE ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352523080535545	CRN-62 RAINGAGE AT COOKSON DAIRY FARM	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352541080441745	CRN-63 RAINGAGE AT ODELL ELEMENTARY SCHOOL	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352555080574445	CRN-34 RAINGAGE AT COWANS FORD DAM WAREHOUSE	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352602081014745	RAINGAGE AT KILLIAN CREEK NR MARIPOSA, NC	02	p24h_va	00045	2013-12-26 10:20:00	EST	0		2013-12-26 10:28:04
USGS	352718080484345	CRN-44 RAINGAGE AT KNOX FARM NR HUNTERSVILLE, NC	08	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	352750080523545	CRN-24, RAINGAGE AT MCDOWELL CR AT CORNELIUS, NC	03	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	352921080473245	CRN-36 RAINGAGE AT WEST FORK SUBSTATION	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:40:02
USGS	353003080591745	CRN-40 RAINGAGE AT WESTPORT GOLF COURSE	06	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:22:03
USGS	353014080524945	CRN-42 RAINGAGE AT NORMAN SHORES AT CORNELIUS, NC	04	p24h_va	00045	2013-12-26 10:30:00	EST	0		2013-12-26 10:38:04
USGS	353135080524245	RAINGAGE AT IR-131 LANGTREE RESEARCH STATION WELL	01	p24h_va	00045	2013-12-26 09:55:00	EST	0		2013-12-26 09:58:03
USGS	354057080362545	RAINGAGE AT RO-149 (NC193) PIEDMONT RS 1 NR BARBER	01	p24h_va	00045	2013-12-26 09:55:00	EST	0		2013-12-26 09:58:03
USGS	354302081433245	RAINGAGE AT GLEN ALPINE RS WELL	01	p24h_va	00045	2013-11-14 11:55:00	EST	Dis		2013-12-21 15:05:03
USGS	354303080354645	RAINGAGE AT SECOND CREEK NEAR BARBER, NC	01	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:08:04
USGS	354353081410545	RAINGAGE NEAR MORGANTON, NC	02	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:48:03
USGS	354616081085145	RAINGAGE AT OXFORD RS NR CLAREMONT, NC	02	p24h_va	00045	2013-12-26 09:45:00	EST	0		2013-12-26 09:48:03
USGS	354822080521501	RAINGAGE AT STATESVILLE, NC	01	p24h_va	00045	2013-12-26 10:10:00	EST	0		2013-12-26 10:18:04
USGS	354855080134201	RAINGAGE AT NCDOT FACILITY AT LEXINGTON, NC	01	p24h_va	00045	2013-12-26 09:40:00	EST	0		2013-12-26 09:48:03
USGS	355020078465645	RAINGAGE AT LAKE CRABTREE CO. PARK NR MORRISVILLE	01	p24h_va	00045	2013-12-26 09:45:00	EST	0.02		2013-12-26 09:52:03
USGS	355031081243245	RAINGAGE AT GRANITE FALLS RESEARCH STATION	02	p24h_va	00045	2013-12-26 09:40:00	EST	0		2013-12-26 09:48:03
USGS	355037080393045	RAINGAGE AT SOUTH YADKIN RIVER NEAR MOCKSVILLE, NC	09	p24h_va	00045	2013-12-26 10:25:00	EST	0		2013-12-26 10:28:04
USGS	355113080230345	RAINGAGE AT YADKIN RIVER AT YADKIN COLLEGE, NC	20	p24h_va	00045	2013-12-26 09:40:00	EST	0		2013-12-26 09:44:03
USGS	355511078570745	RAINGAGE AT THIRD FORK CR WOODCROFT PKWY NR BLANDS	01	p24h_va	00045	2013-12-26 09:30:00	EST	0.02		2013-12-26 09:44:03
USGS	355637079122545	RAINGAGE AT BERRY ANDREWS RD NR WHITE CROSS, NC	01	p24h_va	00045	2013-06-19 23:45:00	EDT	Dis		2013-12-07 17:09:04
USGS	355852078572045	RAINGAGE AT MAUREEN JOY CHARTER SCHOOL NR DURHAM	01	p24h_va	00045	2013-12-26 09:30:00	EST	0		2013-12-26 09:47:05
USGS	355856078492945	RAINGAGE AT LTL LICK CR AT NC HWY 98 OAK GROVE, NC	01	p24h_va	00045	2013-12-26 09:45:00	EST	0.01		2013-12-26 09:52:03
USGS	360000080444645	RAINGAGE AT HUNTING CREEK NR HARMONY, NC	01	p24h_va	00045	2013-12-26 09:55:00	EST	0		2013-12-26 10:00:03
USGS	360143078540945	RAINGAGE AT WEST MURRAY AVENUE AT DURHAM, NC	01	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:12:04
USGS	360334078584145	RAINGAGE AT ENO RIVER NEAR HUCKLEBERRY SPRING, NC	01	p24h_va	00045	2013-12-26 10:00:00	EST	0.01		2013-12-26 10:10:03
USGS	360419078543145	RAINGAGE AT ENO RIVER NEAR DURHAM, NC	01	p24h_va	00045	2013-12-26 10:15:00	EST	0		2013-12-26 10:32:03
USGS	360733079552145	RAINGAGE AT BRUSH CR AT MUIRFIELD RD NR GREENSBORO	02	p24h_va	00045	2013-12-26 10:20:00	EST	0		2013-12-26 10:24:03
USGS	360754080263945	RAINGAGE AT YADKIN RIVER AT ENON, NC	01	p24h_va	00045	2013-12-26 10:10:00	EST	0		2013-12-26 10:16:03
USGS	361210081333001	RAINGAGE AT TRIPLETT, NC	01	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:16:03
USGS	361554081191701	RAINGAGE AT WILBAR, NC	01	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:16:03
USGS	362416080334345	RAINGAGE AT ARARAT RIVER AT ARARAT, NC	01	p24h_va	00045	2013-12-26 10:35:00	EST	0		2013-12-26 10:40:02
USGS	372543079295400	METEOROLOGICAL STATION NEAR BEDFORD, VA	01	p24h_va	00045	2013-12-26 10:00:00	EST	0		2013-12-26 10:18:04
*/

        internal static List<WeatherStation> ParseStations(string p)
        {
            if(p.Contains("No sites were found that meet the following criteria"))
            {
                return new List<WeatherStation>();
            }

            var stationData = new Dictionary<string, WeatherStation>();
            string[] header = null;
            string[] format = null;
            char[] seperator = {'\t'};

            using (StringReader reader = new StringReader(p))
            {
                bool needHeader = true;
                bool needFormatOptions = true;

                while (reader.Peek() != -1)
                {
                    string line = reader.ReadLine().Trim();

                    // skip comment
                    if (line.StartsWith("#"))
                    {
                        continue;
                    }

                    if (needHeader)
                    {
                        header = line.Split(seperator);
                        needHeader = false;
                        continue;
                    }

                    if(needFormatOptions)
                    {
                        format = line.Split(seperator);
                        needFormatOptions = false;
                        continue;
                    }

                    string[] data = line.Split(seperator);
                    if(header.Length != data.Length)
                    {
                        // bad row
                        continue;
                    }

                    string stationId = GetData<string>(header, data, "site_no");
                    WeatherStation station;

                    if(!stationData.TryGetValue(stationId, out station))
                    {
                        station = new WeatherStation
                        {
                            SiteNumber = stationId,
                            Name = GetData<string>(header, data, "station_nm"),
                            Source = GetData<string>(header, data, "agency_cd"),
                            Location = new System.Device.Location.GeoCoordinate(
                                GetData<Double>(header, data, "dec_lat_va"), 
                                GetData<Double>(header, data, "dec_long_va")),
                        };
                        stationData.Add(stationId, station);
                    }

                    Double precip = GetData<Double>(header, data, "result_va");
                    switch(GetData<string>(header, data, "precip_interval_tx"))
                    {
                        case "p24h_va":
                            station.Precipitation1 = precip;
                            break;
                        case "p02d_va":
                            station.Precipitation2 = precip;
                            break;
                        case "p03d_va":
                            station.Precipitation3 = precip;
                            break;
                        case "p04d_va":
                            station.Precipitation4 = precip;
                            break;
                        case "p05d_va":
                            station.Precipitation5 = precip;
                            break;
                        case "p06d_va":
                            station.Precipitation6 = precip;
                            break;
                        case "p07d_va":
                            station.Precipitation7 = precip;
                            break;
                    }

                    station.ResultTime = GetData<DateTime>(header, data, "result_dt");
                }
            }

            return stationData.Values.Where(s => s.SiteNumber != null).ToList();
        }

        private static T GetData<T>(string[] header, string[] data, string headerName)
        {
            for(int i = 0; i < header.Length; i++)
            {
                if(header[i].Equals(headerName, StringComparison.InvariantCultureIgnoreCase))
                {
                    return (T)Convert.ChangeType(data[i], typeof(T));
                }
            }

            return default(T);
        }
    }
}
